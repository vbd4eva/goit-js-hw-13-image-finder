{"version":3,"sources":["webpack:///./js/apiService.js","webpack:///./js/image-finder.js","webpack:///./templates/photo-card.hbs"],"names":["ApiService","optionsObj","this","options","BASE_URL","defaultOptions","page","per_page","key","getUrl","searchQuery","fetchImages","url","fetch","response","json","then","hits","console","log","getImages","apiService","refs","searchForm","document","querySelector","loadMoreBtn","gallery","header","appendImagesMarkup","imgDataArray","insertAdjacentHTML","photoCardTpl","addEventListener","e","preventDefault","currentTarget","elements","query","value","window","scrollTo","top","innerHTML","disabled","pageYOffset","documentElement","clientHeight","behavior","debounce","Handlebars","module","exports","template","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","stack1","program","noop"],"mappings":"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","file":"main.1de32d59333ba33ea690.js","sourcesContent":["export default class ApiService {\r\n\r\n    constructor(optionsObj){ \r\n        this.options = {\r\n            BASE_URL: 'https://pixabay.com/api/',\r\n            defaultOptions: 'image_type=photo&orientation=horizontal',\r\n            page: 1,\r\n            per_page: 12,\r\n            key: '19030678-ed1e5f4c74f32611df53e834e',\r\n            ...optionsObj\r\n        }\r\n    }\r\n    \r\n    getUrl() {\r\n        const { BASE_URL, defaultOptions, searchQuery, page, per_page, key } = this.options;\r\n        const url = `${BASE_URL}?${defaultOptions}&q=${searchQuery}&page=${page}&per_page=${per_page}&key=${key}`;\r\n        return url;\r\n    }\r\n    async fetchImages(url) { \r\n        // return fetch(url)\r\n        //     .then(response => response.json())\r\n        //     .then(({hits}) => { \r\n        //         this.options.page += 1;\r\n        //         return hits;\r\n        //     })\r\n        //     .catch(console.log);\r\n        try {\r\n            const response = await fetch(url);\r\n            this.options.page += 1;\r\n            return response.json()\r\n                .then(({ hits }) => hits);\r\n        }\r\n        catch (error) {\r\n            console.log(\"Ошибка КЕЧ\", error);\r\n        }\r\n    }\r\n            \r\n    getImages(searchQuery) {\r\n\r\n        if (searchQuery) {\r\n            this.options.searchQuery = searchQuery;\r\n            this.options.page = 1;\r\n        }\r\n            \r\n        \r\n        const url = this.getUrl();\r\n\r\n         return this.fetchImages(url);\r\n    }\r\n}\r\n    \r\n    \r\n\r\n","import debounce from 'lodash.debounce';\r\n\r\n\r\nimport ApiService from './apiService';\r\nconst apiService = new ApiService();\r\n\r\n\r\nimport 'material-design-icons/iconfont/material-icons.css';\r\n\r\nimport photoCardTpl from '../templates/photo-card.hbs';\r\n\r\n\r\nconst refs = {\r\n    searchForm: document.querySelector('.search-form'),\r\n    loadMoreBtn: document.querySelector('[data-action=\"load-more\"]'),\r\n    gallery: document.querySelector('.gallery'),\r\n    header: document.querySelector('.header')\r\n}\r\n\r\nrefs.searchForm.addEventListener('submit', onSearch);\r\n\r\nrefs.loadMoreBtn.disabled = true;\r\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\r\n\r\nwindow.addEventListener('scroll', debounce(onScroll, 300));\r\n\r\n\r\nfunction onSearch(e) {\r\n    e.preventDefault();\r\n\r\n    const searchQuery = e.currentTarget.elements.query.value;   \r\n    apiService.getImages(searchQuery)\r\n        .then(imgDataArray => {\r\n            console.log(imgDataArray);\r\n            scrollUp();\r\n            clearImageMarkup();\r\n            refs.loadMoreBtn.disabled = true;\r\n            appendImagesMarkup(imgDataArray);\r\n        });   \r\n}\r\nfunction onLoadMore() { \r\n    apiService.getImages().then((imgDataArray) => {\r\n        appendImagesMarkup(imgDataArray);\r\n        scrollDown();\r\n        refs.loadMoreBtn.disabled = true;\r\n    });   \r\n}\r\n\r\nfunction appendImagesMarkup(imgDataArray) { \r\n    refs.gallery.insertAdjacentHTML('beforeend', photoCardTpl(imgDataArray));\r\n}\r\nfunction clearImageMarkup(){ \r\n    refs.gallery.innerHTML = '';\r\n}\r\n\r\n\r\nfunction onScroll() {\r\n      if ((refs.gallery.clientHeight - document.documentElement.clientHeight) === window.pageYOffset) onScrolledToTheBottom();\r\n }\r\nfunction scrollUp() {  \r\n    window.scrollTo({\r\n        top: 0,\r\n        // behavior: \"smooth\"\r\n    });\r\n}\r\nfunction scrollDown() {  \r\n    const top = window.pageYOffset + document.documentElement.clientHeight - refs.header.clientHeight - 5;\r\n    window.scrollTo({\r\n        top: top,\r\n        behavior: \"smooth\"\r\n    });\r\n}\r\nfunction onScrolledToTheBottom() { \r\n    refs.loadMoreBtn.disabled = false;\r\n    console.log('You scrolled to the bottom');\r\n}\r\n\r\n","var Handlebars = require(\"../../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.hooks.helperMissing, alias3=\"function\", alias4=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"<div class=\\\"photo-card\\\">\\r\\n    <img src=\\\"\"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"webformatURL\") || (depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"webformatURL\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":3,\"column\":14},\"end\":{\"line\":3,\"column\":30}}}) : helper)))\n    + \"\\\" alt=\\\"\\\" />\\r\\n\\r\\n    <div class=\\\"stats\\\">\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">thumb_up</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"likes\") || (depth0 != null ? lookupProperty(depth0,\"likes\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"likes\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":8,\"column\":12},\"end\":{\"line\":8,\"column\":21}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">visibility</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"views\") || (depth0 != null ? lookupProperty(depth0,\"views\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"views\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":12,\"column\":12},\"end\":{\"line\":12,\"column\":21}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">comment</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"comments\") || (depth0 != null ? lookupProperty(depth0,\"comments\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"comments\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":16,\"column\":12},\"end\":{\"line\":16,\"column\":24}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n        <p class=\\\"stats-item\\\">\\r\\n            <i class=\\\"material-icons\\\">cloud_download</i>\\r\\n            \"\n    + alias4(((helper = (helper = lookupProperty(helpers,\"downloads\") || (depth0 != null ? lookupProperty(depth0,\"downloads\") : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"downloads\",\"hash\":{},\"data\":data,\"loc\":{\"start\":{\"line\":20,\"column\":12},\"end\":{\"line\":20,\"column\":25}}}) : helper)))\n    + \"\\r\\n        </p>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n},\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return ((stack1 = lookupProperty(helpers,\"each\").call(depth0 != null ? depth0 : (container.nullContext || {}),depth0,{\"name\":\"each\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data,\"loc\":{\"start\":{\"line\":1,\"column\":0},\"end\":{\"line\":24,\"column\":9}}})) != null ? stack1 : \"\");\n},\"useData\":true});"],"sourceRoot":""}